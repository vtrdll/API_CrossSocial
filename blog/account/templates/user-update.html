{% extends "base.html" %}
{% load widget_tweaks %}

{% block title %}Editar Conta{% endblock %}

{% block content %}
<div class="container mt-4" style="max-width: 800px;">
  
  <!-- ConfiguraÃ§Ãµes da Conta -->
  <div class="card p-4 shadow-sm mb-4">
    <h2 class="mb-4">ğŸ‘¤ ConfiguraÃ§Ãµes da Conta</h2>
    <form method="post">
      {% csrf_token %}
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="{{ form.username.id_for_label }}"  >UsuÃ¡rio</label>
          {{ form.username|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.email.id_for_label }}" >Email</label>
          {{ form.email|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.first_name.id_for_label }}" >Primeiro nome</label>
          {{ form.first_name|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.last_name.id_for_label }}"  >Sobrenome</label>
          {{ form.last_name|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.box.id_for_label }}"  >Box</label>
          {{ form.box|add_class:"form-select" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.category.id_for_label }}" >Categoria</label>
          {{ form.category|add_class:"form-select" }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.genre.id_for_label }}"  >GÃªnero</label>
          {{ form.genre|add_class:"form-select" }}
        </div>

        <div class="col-md-12 mb-4">
          <label for="weightSlider"  >Peso: <span id="weightValue">0</span> kg</label>
          <input 
            type="range" 
            id="weightSlider" 
            name="weight" 
            min="0" 
            max="300" 
            step="0.1" 
            value="{{ form.weight.value|default:0 }}" 
            class="form-range"
          >
        </div>
        
        <div class="col-md-12 mb-4">
          <label for="heightSlider"  class="form-label">
            Altura: <span id="heightValue">0</span> cm
          </label>
          <input
            type="range"
            id="heightSlider"
            name="height"
            min="100"
            max="220"
            step="1"
            value="{{ form.height.value|default:170 }}"
            class="form-range"
          >
        </div>
      </div>

      <div class="d-flex flex-wrap gap-2">
        <button type="submit" name="submit_type" value="user_form" class="btn btn-primary">
      ğŸ’¾ Salvar alteraÃ§Ãµes
    </button>  
        <a href="{% url 'password-change' user.pk %}" class="btn btn-outline-secondary">ğŸ”’ Alterar Senha</a>
        <a href="{% url 'photo-update' user.pk %}" class="btn btn-outline-secondary">ğŸ”’ Alterar foto de perfil</a>

        <a href="{% url 'user-delete' user.pk %}" class="btn btn-outline-danger">ğŸ—‘ï¸ Excluir Conta</a>
      </div>
    </form>
  </div>

  <!-- ConfiguraÃ§Ãµes de Privacidade -->
 
<form method="post">
  {% csrf_token %}
  <div class="form-check form-switch mb-3">
    {{ form_privacy.view_weight }}
    <label class="form-check-label ms-2" for="{{ form_privacy.view_weight.id_for_label }}">
      Mostrar meu peso
    </label>
  </div>
  <div class="form-check form-switch mb-3">
    {{ form_privacy.view_height }}
    <label class="form-check-label ms-2" for="{{ form_privacy.view_height.id_for_label }}">
      Mostrar minha altura
    </label>
  </div>
  <div class="form-check form-switch mb-3">
    {{ form_privacy.view_category }}
    <label class="form-check-label ms-2" for="{{ form_privacy.view_category.id_for_label }}">
      Mostrar minha categoria
    </label>
  </div>
  <div class="form-check form-switch mb-3">
    {{ form_privacy.view_box }}
    <label class="form-check-label ms-2" for="{{ form_privacy.view_box.id_for_label }}">
      Mostrar meu box
    </label>
  </div>
  <div class="form-check form-switch mb-3">
    {{ form_privacy.view_personal_record }}
    <label class="form-check-label ms-2" for="{{ form_privacy.view_personal_record.id_for_label }}">
      Mostrar meu PR
    </label>
  </div>

  <button type="submit" name="submit_type" value="privacy_form" class="btn btn-primary mt-4 w-100">
    ğŸ’¾ Salvar PreferÃªncias
  </button>
</form>

<!-- Sliders JS -->
<script>
  const slider = document.getElementById("weightSlider");
  const output = document.getElementById("weightValue");
  if (slider && output) {
    output.innerText = slider.value;
    slider.oninput = function () {
      output.innerText = this.value;
    };
  }

  const heightSlider = document.getElementById("heightSlider");
  const heightValue = document.getElementById("heightValue");
  if (heightSlider && heightValue) {
    heightValue.innerText = heightSlider.value;
    heightSlider.oninput = function () {
      heightValue.innerText = this.value;
    };
  }
</script>
{% endblock %}
